<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>learning_model.py &mdash; repoclass 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=f2a433a1"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nlp_embedding.py" href="nlp_embedding.html" />
    <link rel="prev" title="set_logger.py" href="set_logger.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            repoclass
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="set_logger.html">set_logger.py</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">learning_model.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.forward"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.train_loop"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.train_loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.test_loop"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.test_loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.evaluate"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.execute"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.build_neural_network"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.build_neural_network()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.add_layer"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.add_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._process_batch_to_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._process_batch_to_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._process_batch_to_one_hot"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._process_batch_to_one_hot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._get_batch_loss"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._get_batch_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._get_multi_one_hot"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._get_multi_one_hot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._configure_input"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._configure_input()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._configure_output"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._configure_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._initialize_weights"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._get_performance"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._get_performance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._compute_total_metrics"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._compute_total_metrics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.category_mappings"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.category_mappings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.max_hidden_neurons"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.max_hidden_neurons</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.hidden_layers"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.hidden_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.use_input_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.use_input_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.use_output_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.use_output_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.train_nlp_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.train_nlp_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.nlp_model_name"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.nlp_model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.device"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._use_input_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._use_input_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._use_output_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._use_output_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._nlp_model_name"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._nlp_model_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._device"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._nlp_embedding_model"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._nlp_embedding_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._output_category_embeddings_nlp"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._output_category_embeddings_nlp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._similarity_threshold"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._similarity_threshold</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._train_nlp_embedding"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._train_nlp_embedding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._input_size"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._input_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork._output_size"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork._output_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.linear_relu_stack"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.linear_relu_stack</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.softmax"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.softmax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.cos"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.cos</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.add_layer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.add_output_possibility"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.add_output_possibility()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.assess_device"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.assess_device()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.build_neural_network()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.execute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.input_categories"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.input_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.input_order"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.input_order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.output_categories"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.output_categories</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#learning_model.CategoricNeuralNetwork.output_category_embeddings_nlp"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.output_category_embeddings_nlp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.test_loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">CategoricNeuralNetwork.train_loop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#learning_model.StopTraining"><code class="docutils literal notranslate"><span class="pre">StopTraining</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nlp_embedding.html">nlp_embedding.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="model_api.html">model_api.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_codes.html">test_codes.py</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">repoclass</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Modules</a></li>
      <li class="breadcrumb-item active">learning_model.py</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/learning_model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="learning-model-py">
<span id="learning-model"></span><h1>learning_model.py<a class="headerlink" href="#learning-model-py" title="Link to this heading"></a></h1>
<div class="toctree-wrapper compound">
</div>
<p id="module-learning_model">This module contains the definition models for the neural network.</p>
<dl class="py class">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">learning_model.</span></span><span class="sig-name descname"><span class="pre">CategoricNeuralNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category_mappings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_hidden_neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_input_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_output_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_nlp_embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlp_model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distilbert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>A neural network model for categoric data.</p>
<p>The model can be trained using a dataset containing input and output data. The model
can be trained to predict the output data based on the input data.</p>
<p>The model is designed to work with categoric data, such as the names of functions
and their test cases. It can be used to predict categories based on the input data.</p>
<p>The model can use embeddings for the input and output data. The input data can be
embedded using a pretrained NLP model, and the output data can be embedded using
the same model. Embedding either is applied independtly of each other.</p>
<p>The model can be trained to update the embeddings of the NLP model. This can be
useful when the model is used in a domain-specific context where the pretrained
embeddings are not sufficient.</p>
<p>The model can be configured to use a different number of hidden layers and neurons
in the hidden layers. The number of hidden layers and neurons can be specified when
creating the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.forward" title="Link to this definition"></a></dt>
<dd><p>The forward pass of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.train_loop">
<span class="sig-name descname"><span class="pre">train_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.train_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.train_loop" title="Link to this definition"></a></dt>
<dd><p>The training loop of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.test_loop">
<span class="sig-name descname"><span class="pre">test_loop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.test_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.test_loop" title="Link to this definition"></a></dt>
<dd><p>The testing loop of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluates the model on a test instance (direct).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.execute" title="Link to this definition"></a></dt>
<dd><p>Executes the model on a test instance (wrapper of evaluate).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.build_neural_network">
<span class="sig-name descname"><span class="pre">build_neural_network</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.build_neural_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.build_neural_network" title="Link to this definition"></a></dt>
<dd><p>Builds the neural network.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.add_layer">
<span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.add_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.add_layer" title="Link to this definition"></a></dt>
<dd><p>Adds a layer to the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._process_batch_to_embedding">
<span class="sig-name descname"><span class="pre">_process_batch_to_embedding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._process_batch_to_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._process_batch_to_embedding" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the batch to embeddings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._process_batch_to_one_hot">
<span class="sig-name descname"><span class="pre">_process_batch_to_one_hot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._process_batch_to_one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._process_batch_to_one_hot" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the batch to one-hot vectors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._get_batch_loss">
<span class="sig-name descname"><span class="pre">_get_batch_loss</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._get_batch_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._get_batch_loss" title="Link to this definition"></a></dt>
<dd><p>Computes the loss for a batch of data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._get_multi_one_hot">
<span class="sig-name descname"><span class="pre">_get_multi_one_hot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._get_multi_one_hot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._get_multi_one_hot" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the field value to a multi-hot vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._configure_input">
<span class="sig-name descname"><span class="pre">_configure_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._configure_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._configure_input" title="Link to this definition"></a></dt>
<dd><p>Initializes the input size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._configure_output">
<span class="sig-name descname"><span class="pre">_configure_output</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._configure_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._configure_output" title="Link to this definition"></a></dt>
<dd><p>Initializes the output size.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._initialize_weights">
<span class="sig-name descname"><span class="pre">_initialize_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Initializes the weights and biases of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._get_performance">
<span class="sig-name descname"><span class="pre">_get_performance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._get_performance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._get_performance" title="Link to this definition"></a></dt>
<dd><p>Calculates the performance of the model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._compute_total_metrics">
<span class="sig-name descname"><span class="pre">_compute_total_metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork._compute_total_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._compute_total_metrics" title="Link to this definition"></a></dt>
<dd><p>Computes the total metrics of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.category_mappings">
<span class="sig-name descname"><span class="pre">category_mappings</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.category_mappings" title="Link to this definition"></a></dt>
<dd><p>A dictionary containing the mappings of the categories.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.max_hidden_neurons">
<span class="sig-name descname"><span class="pre">max_hidden_neurons</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.max_hidden_neurons" title="Link to this definition"></a></dt>
<dd><p>The maximum number of hidden neurons in the hidden layers.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.hidden_layers">
<span class="sig-name descname"><span class="pre">hidden_layers</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.hidden_layers" title="Link to this definition"></a></dt>
<dd><p>The number of hidden layers in the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.use_input_embedding">
<span class="sig-name descname"><span class="pre">use_input_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.use_input_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to use input embeddings or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.use_output_embedding">
<span class="sig-name descname"><span class="pre">use_output_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.use_output_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to use output embeddings or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.train_nlp_embedding">
<span class="sig-name descname"><span class="pre">train_nlp_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.train_nlp_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to train the NLP embedding model or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.nlp_model_name">
<span class="sig-name descname"><span class="pre">nlp_model_name</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.nlp_model_name" title="Link to this definition"></a></dt>
<dd><p>The name of the NLP model to use for embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.device" title="Link to this definition"></a></dt>
<dd><p>The device to use for the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._use_input_embedding">
<span class="sig-name descname"><span class="pre">_use_input_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._use_input_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to use input embeddings or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._use_output_embedding">
<span class="sig-name descname"><span class="pre">_use_output_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._use_output_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to use output embeddings or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._nlp_model_name">
<span class="sig-name descname"><span class="pre">_nlp_model_name</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._nlp_model_name" title="Link to this definition"></a></dt>
<dd><p>The name of the NLP model to use for embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._device">
<span class="sig-name descname"><span class="pre">_device</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._device" title="Link to this definition"></a></dt>
<dd><p>The device to use for the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._nlp_embedding_model">
<span class="sig-name descname"><span class="pre">_nlp_embedding_model</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._nlp_embedding_model" title="Link to this definition"></a></dt>
<dd><p>The NLP embedding model to use for embeddings.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._output_category_embeddings_nlp">
<span class="sig-name descname"><span class="pre">_output_category_embeddings_nlp</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._output_category_embeddings_nlp" title="Link to this definition"></a></dt>
<dd><p>The output category embeddings for the NLP model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._similarity_threshold">
<span class="sig-name descname"><span class="pre">_similarity_threshold</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._similarity_threshold" title="Link to this definition"></a></dt>
<dd><p>The similarity threshold to use for the model (Cosine Embeddings).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._train_nlp_embedding">
<span class="sig-name descname"><span class="pre">_train_nlp_embedding</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._train_nlp_embedding" title="Link to this definition"></a></dt>
<dd><p>Whether to train the NLP embedding model or not.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._input_size">
<span class="sig-name descname"><span class="pre">_input_size</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._input_size" title="Link to this definition"></a></dt>
<dd><p>The size of the input data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork._output_size">
<span class="sig-name descname"><span class="pre">_output_size</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork._output_size" title="Link to this definition"></a></dt>
<dd><p>The size of the output data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.linear_relu_stack">
<span class="sig-name descname"><span class="pre">linear_relu_stack</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.linear_relu_stack" title="Link to this definition"></a></dt>
<dd><p>The neural network model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.softmax">
<span class="sig-name descname"><span class="pre">softmax</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.softmax" title="Link to this definition"></a></dt>
<dd><p>The softmax function.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.cos">
<span class="sig-name descname"><span class="pre">cos</span></span><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.cos" title="Link to this definition"></a></dt>
<dd><p>The cosine similarity function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neurons_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="model_api.html#model_api.ConfigRun.None" title="model_api.ConfigRun.None"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.add_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Adds a layer to the model.</p>
<p>The layer can be a linear layer, and can have normalization,
activation, and dropout layers after it. The layer is added
to the linear_relu_stack attribute of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer</strong> (<em>nn.Module</em>) – The layer to be added.</p></li>
<li><p><strong>neurons</strong> (<em>int</em>) – The number of neurons in the layer.</p></li>
<li><p><strong>add_activation</strong> (<em>bool</em>) – Whether to add an activation function after the layer.</p></li>
<li><p><strong>add_normalization</strong> (<em>bool</em>) – Whether to add a normalization layer after the layer.</p></li>
<li><p><strong>add_drop</strong> (<em>bool</em>) – Whether to add a dropout layer after the layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.add_output_possibility">
<span class="sig-name descname"><span class="pre">add_output_possibility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">category</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">possibility</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="model_api.html#model_api.ConfigRun.None" title="model_api.ConfigRun.None"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.add_output_possibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.add_output_possibility" title="Link to this definition"></a></dt>
<dd><p>Adds an output possibility to the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>category</strong> (<em>str</em>) – The category to add the possibility to.</p></li>
<li><p><strong>possibility</strong> (<em>str</em>) – The possibility to add to the category.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.assess_device">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">assess_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.assess_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.assess_device" title="Link to this definition"></a></dt>
<dd><p>Determines the device to be used for computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device to be used for computation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>device (str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">build_neural_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neurons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_layers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.build_neural_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Builds the neural network.</p>
<p>The neural network is built with a number of hidden layers
and a number of neurons per layer that decreases gradually
from the input size to the output size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neurons</strong> (<em>int</em>) – The number of neurons in the hidden layers.</p></li>
<li><p><strong>number_layers</strong> (<em>int</em>) – The number of hidden layers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>The device used for training the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The device used for training the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>device (torch.device)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'monolabel'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Evaluates the model on a single input.</p>
<p>This is a low-level function that can be used to evaluate the model
on a single input. For a higher-level function that can be used
to evaluate the model on a batch of inputs, use the execute function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>list</em>) – The input data.
It is a list, each element of which is a list of strings.
each element of the list corresponds to a different input category.
each element of the inner list corresponds to a different batch element.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The mode of evaluation.
Can be either ‘monolabel’ or ‘multilabel’ or ‘priority’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The chosen categories.</dt><dd><p>if mode is ‘monolabel’, single element list.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>chosen_categories (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'monolabel'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.execute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Applies the model on a batch of data.</p>
<p>This is a high-level function that can be used to execute the model
on a single input of data. It is just a wrapper around the evaluate function,
to make it easier are more intuitive to use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em>|</em><em>str</em>) – <p>The data to execute the model on.
For a single input category, it can be:</p>
<blockquote>
<div><p>A string
A list of strings.</p>
</div></blockquote>
<dl class="simple">
<dt>For multiple input categories, it should be a list of lists</dt><dd><p>Each element of the outer list corresponds to a different input category.
Each element of the inner list corresponds to a value for that category.</p>
</dd>
</dl>
</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The mode of evaluation.
Can be either ‘monolabel’ or ‘multilabel’ or ‘priority’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The chosen categories.</dt><dd><p>if mode is ‘monolabel’, single element list.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>chosen_categories (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*list</strong><strong>)</strong> (<em>inputs</em>) – <p>The input data.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The logits of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logits (torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.input_categories">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_categories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.input_categories" title="Link to this definition"></a></dt>
<dd><p>The input categories for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The input categories for the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>input_categories (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.input_order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.input_order" title="Link to this definition"></a></dt>
<dd><p>The order of the input categories for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The order of the input categories for the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>input_order (list)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.output_categories">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_categories</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.output_categories" title="Link to this definition"></a></dt>
<dd><p>The output categories for the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The output categories for the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>output_categories (dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="learning_model.CategoricNeuralNetwork.output_category_embeddings_nlp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">output_category_embeddings_nlp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tensor</span></em><a class="headerlink" href="#learning_model.CategoricNeuralNetwork.output_category_embeddings_nlp" title="Link to this definition"></a></dt>
<dd><p>The output category embeddings for the model.
Consider it as base against which to compare the embedded logits.
Consider it as a property to avoid accidental changes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The output category embeddings.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>output_category_embeddings_nlp (torch.Tensor)</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AttributeError</strong> – If the embeddings have not been initialized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">test_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.test_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Function to evaluate the model on a test dataset.</p>
<p>It computes the F1 score, precision, and recall of the model for the test dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – The data loader for the test dataset.</p></li>
<li><p><strong>loss_fn</strong> (<em>torch.nn.Module</em>) – The loss function used for evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The F1 score of the model.
precision (float): The precision of the model.
recall (float): The recall of the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f1_score (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">train_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataLoader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="model_api.html#model_api.ConfigRun.None" title="model_api.ConfigRun.None"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/learning_model.html#CategoricNeuralNetwork.train_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Trains the model using the given dataloader, loss function, and optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<em>torch.utils.data.DataLoader</em>) – The dataloader containing the training dataset.</p></li>
<li><p><strong>loss_fn</strong> (<em>torch.nn.Module</em>) – The loss function used to compute the loss.</p></li>
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – The optimizer used to update the model’s parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="learning_model.StopTraining">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">learning_model.</span></span><span class="sig-name descname"><span class="pre">StopTraining</span></span><a class="reference internal" href="_modules/learning_model.html#StopTraining"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#learning_model.StopTraining" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom exception to stop training the model.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="set_logger.html" class="btn btn-neutral float-left" title="set_logger.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nlp_embedding.html" class="btn btn-neutral float-right" title="nlp_embedding.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Enric Basso.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>